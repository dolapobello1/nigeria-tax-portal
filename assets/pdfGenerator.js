import { jsPDF } from "https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";

export function generatePDF(taxData) {
    if (!taxData) {
        alert("No tax data available to generate PDF!");
        return;
    }

    const doc = new jsPDF();

    // Title
    doc.setFontSize(18);
    doc.setTextColor(16, 185, 129);
    doc.text("Nigeria Tax Filing 2026", 105, 15, { align: "center" });

    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);

    // Section: Income
    doc.text("INCOME DETAILS", 20, 30);
    doc.text(`Gross Income: ₦${taxData.grossIncome.toLocaleString()}`, 20, 38);
    doc.text(`Other Income: ₦${taxData.otherIncome.toLocaleString()}`, 20, 46);
    doc.text(`Total Income: ₦${taxData.totalIncome.toLocaleString()}`, 20, 54);

    // Section: Deductions
    doc.text("DEDUCTIONS & RELIEF", 20, 70);
    doc.text(`Rent Paid: ₦${taxData.rentPaid.toLocaleString()}`, 20, 78);
    doc.text(`Pension/NHF: ₦${taxData.pensionNHF.toLocaleString()}`, 20, 86);
    if (taxData.otherDeductions) {
        doc.text(`Other Deductions: ₦${taxData.otherDeductions.toLocaleString()}`, 20, 94);
    }
    doc.text(`Total Deductions: ₦${taxData.totalDeductions.toLocaleString()}`, 20, 102);

    // Section: Taxable Income
    doc.text("TAX CALCULATION", 20, 118);
    doc.text(`Taxable Income: ₦${taxData.taxableIncome.toLocaleString()}`, 20, 126);
    doc.text(`Personal Income Tax (7%): ₦${taxData.pit.toLocaleString()}`, 20, 134);
    const effectiveRate = taxData.totalIncome ? ((taxData.pit / taxData.totalIncome) * 100).toFixed(2) : 0;
    doc.text(`Effective Tax Rate: ${effectiveRate}%`, 20, 142);

    // Footer
    doc.setFontSize(10);
    doc.setTextColor(128, 128, 128);
    doc.text("Generated by Nigeria TaxFiling Portal", 105, 280, { align: "center" });

    doc.save(`Nigeria_Tax_Filing_2026_${new Date().toISOString().slice(0,10)}.pdf`);
}
